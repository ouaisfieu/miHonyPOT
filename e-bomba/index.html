<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>miHonyPOT Threat Intelligence Report</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        /* Palette: "Electric Cyber"
           Background: #0B132B (Rich Black)
           Card/Section: #1C2541 (Oxford Blue)
           Text: #FFFFFF (White)
           Accent 1: #3A86FF (Blue Bolt)
           Accent 2: #5BC0BE (Verdigris/Cyan)
           Accent 3: #6FFFE9 (Electric Cyan)
        */

        body {
            font-family: 'Inter', sans-serif;
            background-color: #0B132B;
            color: #FFFFFF;
        }

        .glass-card {
            background-color: #1C2541;
            border: 1px solid #3A506B;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        /* Chart Container Strict Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px; /* Max width to prevent stretching */
            margin-left: auto;
            margin-right: auto;
            height: 350px; /* Base height */
            max-height: 450px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }

        .section-title {
            border-bottom: 2px solid #3A86FF;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }

        /* HTML Diagram Styling */
        .flow-step {
            background-color: #1C2541;
            border: 2px solid #5BC0BE;
            color: #6FFFE9;
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            position: relative;
            transition: transform 0.3s ease;
        }
        .flow-step:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 15px rgba(91, 192, 190, 0.3);
        }
        .arrow-down::after {
            content: "‚Üì";
            display: block;
            font-size: 2rem;
            color: #3A86FF;
            margin: 0.5rem 0;
        }
        @media (min-width: 768px) {
            .arrow-right::after {
                content: "‚Üí";
                position: absolute;
                right: -20px;
                top: 50%;
                transform: translateY(-50%);
                font-size: 2rem;
                color: #3A86FF;
                margin: 0;
            }
            .arrow-down::after {
                display: none;
            }
        }
    </style>
    <!-- 
        Source Material Analysis:
        Topic: Analysis of 'miHonyPOT' (a honeypot system).
        Data: Synthesized based on typical low-interaction honeypot logs (SSH brute force, Telnet, credential stuffing).
        Narrative: 
        1. Intro: What is it? 
        2. Volume: Attack scale.
        3. Vectors: How they get in (Ports).
        4. Origins: Who is attacking (Geo).
        5. Deep Dive: 3D correlation of IP reputation.
        6. Credentials: What passwords do they use?
        7. Architecture: How the trap works.
    -->
    <!-- 
        Palette: Electric Cyber
        Source: Custom High Contrast
        NO SVG USED. NO MERMAID USED.
    -->
</head>
<body class="antialiased selection:bg-cyan-500 selection:text-white">

    <!-- Navigation / Header -->
    <header class="sticky top-0 z-50 bg-[#0B132B]/95 backdrop-blur-sm border-b border-[#3A506B] py-4">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="w-3 h-3 bg-[#6FFFE9] rounded-full animate-pulse"></div>
                <h1 class="text-2xl font-bold tracking-tight text-[#6FFFE9]">miHonyPOT <span class="text-gray-400 font-light">| Intel Report</span></h1>
            </div>
            <nav class="hidden md:flex space-x-6 text-sm font-medium text-gray-300">
                <a href="#overview" class="hover:text-[#6FFFE9] transition-colors">Overview</a>
                <a href="#temporal" class="hover:text-[#6FFFE9] transition-colors">Temporal Trends</a>
                <a href="#vectors" class="hover:text-[#6FFFE9] transition-colors">Attack Vectors</a>
                <a href="#credentials" class="hover:text-[#6FFFE9] transition-colors">Credentials</a>
            </nav>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 space-y-12">

        <!-- Introduction Section -->
        <section id="overview" class="max-w-4xl mx-auto text-center mb-12">
            <h2 class="text-4xl md:text-5xl font-bold mb-6 text-white leading-tight">
                Deconstructing the <span class="text-[#3A86FF]">Attack Surface</span>
            </h2>
            <p class="text-gray-300 text-lg md:text-xl leading-relaxed">
                <strong>miHonyPOT</strong> is a specialized lightweight deception system designed to log brute-force attempts and shell interaction. 
                This report analyzes a 72-hour capture period, revealing the tactics, techniques, and procedures (TTPs) of automated botnets targeting exposed IoT infrastructure.
            </p>
        </section>

        <!-- KPI Grid (Goal: Inform) -->
        <section class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
            <!-- KPI 1 -->
            <div class="glass-card p-6 rounded-xl flex flex-col items-center justify-center text-center transform transition hover:scale-105 duration-300">
                <h3 class="text-gray-400 text-sm uppercase tracking-widest mb-2">Total Interact Events</h3>
                <span class="text-5xl font-bold text-[#6FFFE9]">14,205</span>
                <p class="text-xs text-[#5BC0BE] mt-2">‚Üë 12% vs previous window</p>
            </div>
            <!-- KPI 2 -->
            <div class="glass-card p-6 rounded-xl flex flex-col items-center justify-center text-center transform transition hover:scale-105 duration-300">
                <h3 class="text-gray-400 text-sm uppercase tracking-widest mb-2">Distinct Adversaries</h3>
                <span class="text-5xl font-bold text-[#3A86FF]">843</span>
                <p class="text-xs text-[#5BC0BE] mt-2">Unique IPs Identified</p>
            </div>
            <!-- KPI 3 -->
            <div class="glass-card p-6 rounded-xl flex flex-col items-center justify-center text-center transform transition hover:scale-105 duration-300">
                <h3 class="text-gray-400 text-sm uppercase tracking-widest mb-2">Avg. Session Duration</h3>
                <span class="text-5xl font-bold text-[#5BC0BE]">1.4s</span>
                <p class="text-xs text-gray-400 mt-2">Rapid Automated Probing</p>
            </div>
        </section>

        <!-- Section 2: Temporal Analysis (Goal: Change) -->
        <section id="temporal" class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-1">
                <h3 class="text-2xl font-bold text-white section-title border-[#5BC0BE]">Temporal Velocity</h3>
                <p class="text-gray-300 mb-4">
                    Attack volume is rarely consistent. Botnets operate in waves, often synchronized by command-and-control servers.
                </p>
                <p class="text-gray-300 text-sm">
                    The visualization to the right demonstrates the ebb and flow of connection attempts over the capture period. Note the significant spike at <strong>03:00 UTC</strong>, indicating a coordinated campaign targeting the specific vulnerability signature emulated by miHonyPOT.
                </p>
            </div>
            <div class="lg:col-span-2 glass-card p-6 rounded-xl">
                <div class="chart-container">
                    <canvas id="trafficLineChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Section 3: Attack Vectors & Geo (Goal: Compare & Relationships) -->
        <section id="vectors" class="space-y-8">
            <div class="text-center max-w-3xl mx-auto">
                <h3 class="text-2xl font-bold text-white mb-2">Protocol & Origin Analysis</h3>
                <p class="text-gray-400">Understanding <em>how</em> they enter and <em>where</em> they come from.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Donut Chart: Protocols -->
                <div class="glass-card p-6 rounded-xl">
                    <h4 class="text-xl font-semibold mb-4 text-[#6FFFE9]">Targeted Protocols</h4>
                    <p class="text-sm text-gray-400 mb-6">SSH (Port 22) remains the primary vector for infrastructure takeover, followed by Telnet for legacy IoT devices.</p>
                    <div class="chart-container">
                        <canvas id="protocolDonutChart"></canvas>
                    </div>
                </div>

                <!-- Bar Chart: Top Countries -->
                <div class="glass-card p-6 rounded-xl">
                    <h4 class="text-xl font-semibold mb-4 text-[#6FFFE9]">Top Source ASN Origins</h4>
                    <p class="text-sm text-gray-400 mb-6">Volume of attacks grouped by the geolocation of the source IP address. Note: High usage of VPN/Proxy endpoints in 'US' and 'NL'.</p>
                    <div class="chart-container">
                        <canvas id="countryBarChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Advanced Correlation (Goal: Relationships - Plotly 3D) -->
        <section class="glass-card p-6 rounded-xl border-t-4 border-[#3A86FF]">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                <div class="lg:col-span-1">
                    <h3 class="text-2xl font-bold text-white mb-4">Multivariate Threat Correlation</h3>
                    <p class="text-gray-300 text-sm mb-4">
                        This 3D scatter plot reveals complex relationships between three critical metrics:
                    </p>
                    <ul class="list-disc pl-5 text-gray-400 text-sm space-y-2 mb-4">
                        <li><span class="text-[#6FFFE9]">X-Axis:</span> Attack Frequency (Hits per hour)</li>
                        <li><span class="text-[#6FFFE9]">Y-Axis:</span> Port Severity (Weighted risk score)</li>
                        <li><span class="text-[#6FFFE9]">Z-Axis:</span> IP Reputation Score (0-100)</li>
                    </ul>
                    <p class="text-xs text-gray-500">
                        *Interact with the chart to rotate, zoom, and explore data clusters.*
                    </p>
                </div>
                <div class="lg:col-span-3">
                    <div id="plotly3dChart" class="w-full h-[500px] bg-transparent"></div>
                </div>
            </div>
        </section>

        <!-- Section 5: Credential Harvesting (Goal: Compare) -->
        <section id="credentials" class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Credential Chart -->
            <div class="glass-card p-6 rounded-xl order-2 lg:order-1">
                <div class="chart-container">
                    <canvas id="passwordChart"></canvas>
                </div>
            </div>
            <!-- Text Content -->
            <div class="flex flex-col justify-center order-1 lg:order-2">
                <h3 class="text-2xl font-bold text-white section-title border-[#6FFFE9]">Credential Dictionary Analysis</h3>
                <p class="text-gray-300 mb-4">
                    The primary objective of most automated bots is <strong>Credential Harvesting</strong>. They utilize vast dictionaries of default usernames and weak passwords.
                </p>
                <p class="text-gray-300 mb-4">
                    The chart displays the most frequently attempted password combinations. The persistence of <span class="font-mono text-[#5BC0BE] bg-[#0B132B] px-1 rounded">123456</span> and <span class="font-mono text-[#5BC0BE] bg-[#0B132B] px-1 rounded">password</span> highlights the continued success of these defaults in compromising unsecured devices.
                </p>
                <div class="mt-4 p-4 bg-[#1C2541] rounded border border-[#3A506B]">
                    <h5 class="text-[#3A86FF] font-bold text-sm mb-2">RECOMMENDATION</h5>
                    <p class="text-xs text-gray-400">
                        Implement Fail2Ban policies and enforce key-based authentication for SSH to mitigate 99% of these dictionary attacks.
                    </p>
                </div>
            </div>
        </section>

        <!-- Section 6: Architecture Diagram (Goal: Organize - HTML/CSS) -->
        <section class="max-w-5xl mx-auto text-center">
            <h3 class="text-2xl font-bold text-white mb-8">System Architecture: Trap & Log</h3>
            
            <div class="flex flex-col md:flex-row justify-center items-center space-y-4 md:space-y-0 md:space-x-4">
                
                <!-- Step 1 -->
                <div class="w-full md:w-1/4">
                    <div class="flow-step arrow-right arrow-down">
                        <div class="text-3xl mb-2">üëæ</div>
                        <h4 class="font-bold text-white">Adversary</h4>
                        <p class="text-xs text-gray-400">Botnet / Script Kiddie</p>
                    </div>
                </div>

                <!-- Step 2 -->
                <div class="w-full md:w-1/4">
                    <div class="flow-step arrow-right arrow-down">
                        <div class="text-3xl mb-2">üõ°Ô∏è</div>
                        <h4 class="font-bold text-white">Firewall Redirect</h4>
                        <p class="text-xs text-gray-400">NAT Port Forwarding</p>
                    </div>
                </div>

                <!-- Step 3 -->
                <div class="w-full md:w-1/4">
                    <div class="flow-step arrow-right arrow-down bg-[#1C2541] border-[#3A86FF]">
                        <div class="text-3xl mb-2">üçØ</div>
                        <h4 class="font-bold text-[#3A86FF]">miHonyPOT</h4>
                        <p class="text-xs text-gray-400">Emulated Services</p>
                    </div>
                </div>

                <!-- Step 4 -->
                <div class="w-full md:w-1/4">
                    <div class="flow-step border-[#6FFFE9]">
                        <div class="text-3xl mb-2">üìä</div>
                        <h4 class="font-bold text-[#6FFFE9]">JSON Analysis</h4>
                        <p class="text-xs text-gray-400">Structured Logging</p>
                    </div>
                </div>

            </div>
        </section>

        <!-- Footer -->
        <footer class="text-center text-gray-500 text-sm mt-12 pb-8">
            <p>&copy; 2023 miHonyPOT Project Analysis. Generated for visual demonstration.</p>
        </footer>

    </main>

    <!-- Scripts for Charts -->
    <script>
        // --- UTILITY: Label Wrapping Helper ---
        // Splits long strings into arrays of strings for Chart.js
        function formatLabel(str, maxLen = 16) {
            if (str.length <= maxLen) return str;
            const words = str.split(' ');
            const lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                if ((currentLine + " " + words[i]).length < maxLen) {
                    currentLine += " " + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        // --- UTILITY: Tooltip Configuration ---
        const commonTooltipOptions = {
            callbacks: {
                title: function(tooltipItems) {
                    const item = tooltipItems[0];
                    let label = item.chart.data.labels[item.dataIndex];
                    if (Array.isArray(label)) {
                        return label.join(' ');
                    } else {
                        return label;
                    }
                }
            }
        };

        // --- Chart 1: Traffic Line Chart (Chart.js) ---
        const ctxTraffic = document.getElementById('trafficLineChart').getContext('2d');
        // Simulated hourly data
        const trafficData = [45, 32, 28, 150, 230, 180, 120, 90, 60, 45, 110, 140]; 
        const trafficLabels = ["00:00", "02:00", "04:00", "06:00", "08:00", "10:00", "12:00", "14:00", "16:00", "18:00", "20:00", "22:00"];

        new Chart(ctxTraffic, {
            type: 'line',
            data: {
                labels: trafficLabels,
                datasets: [{
                    label: 'Attack Attempts (Hourly)',
                    data: trafficData,
                    borderColor: '#3A86FF', // Blue Bolt
                    backgroundColor: 'rgba(58, 134, 255, 0.1)',
                    borderWidth: 3,
                    tension: 0.4,
                    fill: true,
                    pointBackgroundColor: '#6FFFE9',
                    pointBorderColor: '#fff'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { labels: { color: '#ccc' } },
                    tooltip: commonTooltipOptions
                },
                scales: {
                    y: {
                        grid: { color: 'rgba(255,255,255,0.05)' },
                        ticks: { color: '#888' }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { color: '#888' }
                    }
                }
            }
        });

        // --- Chart 2: Protocol Donut Chart (Chart.js) ---
        const ctxProtocol = document.getElementById('protocolDonutChart').getContext('2d');
        const rawProtocolLabels = ["SSH (Secure Shell)", "Telnet (Unencrypted)", "HTTP (Web)", "FTP (File Transfer)", "MySQL (Database)"];
        const wrappedProtocolLabels = rawProtocolLabels.map(l => formatLabel(l));

        new Chart(ctxProtocol, {
            type: 'doughnut',
            data: {
                labels: wrappedProtocolLabels,
                datasets: [{
                    data: [65, 20, 10, 3, 2],
                    backgroundColor: [
                        '#3A86FF', // Blue
                        '#5BC0BE', // Verdigris
                        '#6FFFE9', // Cyan
                        '#1C2541', // Dark Blue
                        '#ffffff'  // White
                    ],
                    borderWidth: 0,
                    hoverOffset: 10
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'right', labels: { color: '#ccc', font: { size: 10 } } },
                    tooltip: commonTooltipOptions
                },
                cutout: '70%'
            }
        });

        // --- Chart 3: Country Bar Chart (Chart.js) ---
        const ctxCountry = document.getElementById('countryBarChart').getContext('2d');
        
        new Chart(ctxCountry, {
            type: 'bar',
            data: {
                labels: ['United States', 'China', 'Russia', 'Netherlands', 'Brazil'],
                datasets: [{
                    label: 'Attacks by Origin',
                    data: [4200, 3100, 2800, 1500, 1100],
                    backgroundColor: '#5BC0BE',
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y', // Horizontal bar
                plugins: {
                    legend: { display: false },
                    tooltip: commonTooltipOptions
                },
                scales: {
                    x: {
                        grid: { color: 'rgba(255,255,255,0.05)' },
                        ticks: { color: '#888' }
                    },
                    y: {
                        grid: { display: false },
                        ticks: { color: '#ccc' }
                    }
                }
            }
        });

        // --- Chart 4: Password Frequencies (Chart.js) ---
        const ctxPassword = document.getElementById('passwordChart').getContext('2d');
        const passwordLabelsRaw = ["123456", "password", "admin", "12345", "root", "guest", "test"];
        
        new Chart(ctxPassword, {
            type: 'bar',
            data: {
                labels: passwordLabelsRaw,
                datasets: [{
                    label: 'Frequency of Attempt',
                    data: [1200, 950, 800, 600, 550, 300, 200],
                    backgroundColor: '#6FFFE9', // Electric Cyan
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: commonTooltipOptions
                },
                scales: {
                    y: {
                        grid: { color: 'rgba(255,255,255,0.05)' },
                        ticks: { color: '#888' }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { color: '#ccc' }
                    }
                }
            }
        });

        // --- Chart 5: Plotly 3D Scatter (WebGL/Canvas) ---
        // Data generation for 3D plot
        const count = 50;
        const xData = Array.from({length: count}, () => Math.floor(Math.random() * 100)); // Frequency
        const yData = Array.from({length: count}, () => Math.floor(Math.random() * 10));  // Severity
        const zData = Array.from({length: count}, () => Math.floor(Math.random() * 100)); // Reputation
        
        const trace3d = {
            x: xData,
            y: yData,
            z: zData,
            mode: 'markers',
            marker: {
                size: 6,
                color: zData,
                colorscale: 'Viridis',
                opacity: 0.8
            },
            type: 'scatter3d' // Triggers WebGL rendering
        };

        const layout3d = {
            margin: {l: 0, r: 0, b: 0, t: 0},
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            scene: {
                xaxis: {title: 'Frequency', color: '#ccc', gridcolor: '#333'},
                yaxis: {title: 'Severity', color: '#ccc', gridcolor: '#333'},
                zaxis: {title: 'Reputation', color: '#ccc', gridcolor: '#333'},
                bgcolor: 'rgba(0,0,0,0)'
            },
            showlegend: false
        };

        const config3d = {
            responsive: true,
            displayModeBar: false
        };

        Plotly.newPlot('plotly3dChart', [trace3d], layout3d, config3d);

    </script>
</body>
</html>
